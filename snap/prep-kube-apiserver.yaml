name: kube-apiserver
version: '$KUBE_ERSION'
summary: kube-apiserver
description: kube-apiserver
grade: stable
confinement: strict

apps:
  daemon:
    command: run-with-config-args kube-apiserver
    daemon: simple
    plugs:
        - home
        - network
        - network-bind
  kube-apiserver:
    command: kube-apiserver
    plugs:
        - home
        - network
        - network-bind
parts:
  kube-apiserver:
    plugin: dump
    source: build
    prepare: |
      set -eu
      export KUBE_ARCH=`dpkg --print-architecture`
      curl -LO https://dl.k8s.io/v$KUBE_ERSION/bin/linux/${KUBE_ARCH}/kube-apiserver
      chmod +x kube-apiserver
      cp ../../../shared/run-with-config-args .
      ../../../shared/generate-configure-hook kube-apiserver
